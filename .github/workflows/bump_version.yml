name: Bump package version

on:
  push:
    branches:
      - "main"
      - "dev/[0-9]+.[0-9]+.[0-9]+"

jobs:
  bump:
    name: Bump package version
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GH_TOKEN }}

      - name: Set up Python and Upgrade pip
        uses: ./.github/actions/setup_python
        with:
          python-version: "3.11"

      - name: Update package version (main branch)
        if: github.ref == 'refs/heads/main'
        uses: ./.github/actions/bump_version
        with:
          type: "release"
          commit: true
          tag: true
          push: true

      - name: Update package version (dev branch)
        if: contains(github.ref, 'refs/heads/dev/')
        uses: ./.github/actions/bump_version
        with:
          type: "build"
          commit: true
          tag: false
          push: true
